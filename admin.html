<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>NEO ADMIN - PRO WORKSTATION</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Dancing+Script&family=Pacifico&family=Bebas+Neue&family=Great+Vibes&family=Monoton&family=Press+Start+2P&family=Rajdhani&family=Satisfy&family=Comfortaa&family=Righteous&family=Cinzel&family=Lobster&family=Kaushan+Script&family=Permanent+Marker&family=Exo+2&family=Abril+Fatface&family=Unbounded&family=Special+Elite&family=Russo+One&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a0a; color: white; display: flex; height: 100vh; margin: 0; overflow: hidden; }
        .settings-panel { width: 420px; background: #181818; padding: 15px; overflow-y: auto; border-right: 2px solid #333; }
        .preview-panel { flex: 1; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .templates-panel { width: 320px; background: #181818; padding: 15px; border-left: 2px solid #333; overflow-y: auto; }
        iframe { width: 340px; height: 600px; border: 12px solid #222; border-radius: 35px; background: #000; }
        .section { background: #222; padding: 10px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #0f0; }
        h4 { margin: 0 0 8px 0; font-size: 0.7rem; color: #0f0; text-transform: uppercase; }
        label { font-size: 0.55rem; color: #aaa; text-transform: uppercase; }
        input, select { width: 100%; padding: 6px; background: #333; color: #fff; border: 1px solid #444; border-radius: 4px; margin-top: 2px; font-size: 0.8rem; }
        .row { display: flex; gap: 5px; } .row > div { flex: 1; }
        .num { text-align: center; color: #0f0; font-weight: bold; background: #444; }
        .live-toggle { background: #0f0; color: #000; padding: 10px; text-align: center; font-weight: bold; cursor: pointer; border-radius: 5px; margin-bottom: 15px; }
        .live-toggle.off { background: #444; color: #fff; }
        .template-item { background: #2a2a2a; padding: 10px; border-radius: 5px; margin-bottom: 8px; cursor: pointer; border: 1px solid #444; font-size: 0.8rem; }
        #save-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #222; padding: 20px; border: 2px solid #0f0; z-index: 1000; display: none; width: 300px; box-shadow: 0 0 50px #000; }
        #url-display { font-size: 10px; color: #555; margin-top: 10px; word-break: break-all; width: 340px; text-align: center; }
    </style>
</head>
<body>

    <div id="save-modal">
        <h4>Sablon ment√©se</h4>
        <label>V√°lassz megl√©v≈ët vagy √∫jat:</label>
        <select id="modal-name-list" onchange="toggleNewName()"></select>
        <input type="text" id="modal-new-name" placeholder="√öj sablon neve..." style="margin-top:10px; display:none;">
        <button onclick="confirmSave()" style="background:#0f0; color:#000; margin-top:10px; width:100%; border:none; padding:10px; font-weight:bold;">MENT√âS</button>
        <button onclick="document.getElementById('save-modal').style.display='none'" style="background:#444; color:#fff; width:100%; border:none; padding:10px; margin-top:5px;">M√âGSE</button>
    </div>

    <div class="settings-panel">
        <div id="edit-toggle" class="live-toggle off" onclick="toggleEdit()">SZERKESZT≈ê M√ìD: KI</div>
        
        <div class="section">
            <h4>Gomb & C√≠m</h4>
            <input type="text" id="btn" placeholder="Gomb felirata (pl. START)" oninput="update()">
            <input type="text" id="cim" placeholder="F≈ëc√≠m sz√∂vege" oninput="update()">
            <div class="row">
                <div><label>Bet≈±</label><select id="mf" onchange="update()"></select></div>
                <div><label>Sz√≠n</label><input type="color" id="mc" value="#00ff00" oninput="update()"></div>
                <div><label>S%</label><input type="number" id="ms" placeholder="4" oninput="update()" class="num"></div>
            </div>
            <div class="row">
                <div><label>X%</label><input type="number" id="mx" placeholder="50" oninput="update()" class="num"></div>
                <div><label>Y%</label><input type="number" id="my" placeholder="40" oninput="update()" class="num"></div>
            </div>
        </div>

        <div class="section" style="border-left-color: #0df;">
            <h4>Alc√≠m</h4>
            <input type="text" id="alcim" placeholder="Alc√≠m sz√∂vege" oninput="update()">
            <div class="row">
                <div><label>Bet≈±</label><select id="sf" onchange="update()"></select></div>
                <div><label>Sz√≠n</label><input type="color" id="sc" value="#ffffff" oninput="update()"></div>
                <div><label>S%</label><input type="number" id="ss" placeholder="2.5" oninput="update()" class="num"></div>
            </div>
            <div class="row">
                <div><label>X%</label><input type="number" id="sx" placeholder="50" oninput="update()" class="num"></div>
                <div><label>Y%</label><input type="number" id="sy" placeholder="60" oninput="update()" class="num"></div>
            </div>
        </div>

        <div class="section" style="border-left-color: #fff;">
            <h4>K√©pek (W% / H%)</h4>
            <input type="text" id="d1url" placeholder="K√©p 1 URL" oninput="update()">
            <div class="row">
                <div><label>X%</label><input type="number" id="d1x" placeholder="20" oninput="update()" class="num"></div>
                <div><label>Y%</label><input type="number" id="d1y" placeholder="20" oninput="update()" class="num"></div>
                <div><label>W%</label><input type="number" id="d1w" placeholder="15" oninput="update()" class="num"></div>
                <div><label>H%</label><input type="number" id="d1h" placeholder="15" oninput="update()" class="num"></div>
                <div><label>R%</label><input type="number" id="d1r" placeholder="0" oninput="update()" class="num"></div>
            </div>
            <input type="text" id="d2url" placeholder="K√©p 2 URL" style="margin-top:10px;" oninput="update()">
            <div class="row">
                <div><label>X%</label><input type="number" id="d2x" placeholder="80" oninput="update()" class="num"></div>
                <div><label>Y%</label><input type="number" id="d2y" placeholder="20" oninput="update()" class="num"></div>
                <div><label>W%</label><input type="number" id="d2w" placeholder="15" oninput="update()" class="num"></div>
                <div><label>H%</label><input type="number" id="d2h" placeholder="15" oninput="update()" class="num"></div>
                <div><label>R%</label><input type="number" id="d2r" placeholder="0" oninput="update()" class="num"></div>
            </div>
        </div>

        <div class="section" style="border-left-color: #f0f;">
            <h4>Effekt & Vide√≥</h4>
            <select id="eff" onchange="update()">
                <option value="none">Nincs Effekt</option><option value="heart">Sz√≠v</option><option value="snow">H√≥</option><option value="bday">üéâ</option><option value="custom">EGYEDI</option>
            </select>
            <input type="text" id="eff_url" placeholder="Egyedi effekt PNG URL" oninput="update()">
            <input type="text" id="yt" placeholder="YouTube Video ID" oninput="update()" style="margin-top:10px;">
            <div class="row">
                <div><label>VW%</label><input type="number" id="vw" placeholder="100" oninput="update()" class="num"></div>
                <div><label>VH%</label><input type="number" id="vh" placeholder="100" oninput="update()" class="num"></div>
                <div style="text-align:center;"><label>Mute</label><input type="checkbox" id="mute" onchange="update()"></div>
            </div>
        </div>
    </div>

    <div class="preview-panel">
        <iframe id="ifr" src="index.html"></iframe>
        <div id="url-display">V√°rakoz√°s...</div>
    </div>

    <div class="templates-panel">
        <h4>üìÅ Sablonok</h4>
        <select id="main-cat" onchange="updateSubCats()"></select>
        <select id="sub-cat" onchange="renderTemplates()" style="margin-top:5px;"></select>
        <div id="template-list" style="margin: 15px 0;"></div>
        <button onclick="copyLink()" style="background:#0f0; border:none; padding:10px; font-weight:bold; cursor:pointer; width:100%;">LINK M√ÅSOL√ÅSA</button>
        <button onclick="openSaveModal()" style="background:#007bff; color:#fff; border:none; padding:10px; font-weight:bold; cursor:pointer; width:100%; margin-top:5px;">SABLON MENT√âSE</button>
        <textarea id="json-out" style="width:100%; height:80px; font-size:10px; margin-top:10px; display:none;"></textarea>
    </div>

<script>
    let editMode = false;
    const fonts = ["Orbitron", "Dancing Script", "Pacifico", "Bebas Neue", "Great Vibes", "Monoton", "Press Start 2P", "Rajdhani", "Satisfy", "Comfortaa", "Righteous", "Cinzel", "Lobster", "Kaushan Script", "Permanent Marker", "Exo 2", "Abril Fatface", "Unbounded", "Special Elite", "Russo One"];
    const inputIds = ['btn','cim','mc','ms','mf','mx','my','alcim','sc','ss','sf','sx','sy','eff','eff_url','yt','vw','vh','mute','d1url','d1x','d1y','d1w','d1h','d1r','d2url','d2x','d2y','d2w','d2h','d2r'];
    let catData = {}, templates = [];

    async function init() {
        // Mez≈ëk √ºr√≠t√©se
        inputIds.forEach(id => { 
            const el = document.getElementById(id); 
            if(el.type === 'checkbox') el.checked = false; 
            else if(el.type === 'color') el.value = (id==='mc'?'#00ff00':'#ffffff');
            else el.value = ''; 
        });

        // Bet≈±t√≠pusok felt√∂lt√©se
        ['mf','sf'].forEach(id => fonts.forEach(f => document.getElementById(id).add(new Option(f, f))));

        try {
            const cRes = await fetch('categories.json');
            catData = (await cRes.json()).categories;
            Object.keys(catData).forEach(k => document.getElementById('main-cat').add(new Option(k, k)));
            updateSubCats();

            const tRes = await fetch('templates.json');
            templates = (await tRes.json()).templates;
            renderTemplates();
        } catch(e) { console.warn("JSON f√°jlok nem tal√°lhat√≥k."); }
        update();
    }

    function toggleEdit() {
        editMode = !editMode;
        const btn = document.getElementById('edit-toggle');
        btn.innerText = "SZERKESZT≈ê M√ìD: " + (editMode ? "BE" : "KI");
        btn.className = "live-toggle " + (editMode ? "" : "off");
        update();
    }

    function updateSubCats() {
        const sub = document.getElementById('sub-cat'); sub.innerHTML = "";
        const main = document.getElementById('main-cat').value;
        if(catData[main]) catData[main].forEach(s => sub.add(new Option(s, s)));
        renderTemplates();
    }

    function renderTemplates() {
        const sub = document.getElementById('sub-cat').value;
        const list = document.getElementById('template-list'); list.innerHTML = "";
        templates.filter(t => t.subCategory === sub).forEach(t => {
            const d = document.createElement('div'); d.className = 'template-item';
            d.onclick = () => loadT(t.params); d.innerText = t.name;
            list.appendChild(d);
        });
    }

    function loadT(pStr) {
        const p = new URLSearchParams(pStr);
        p.forEach((v, k) => {
            const id = k==='effect'?'eff':k;
            const el = document.getElementById(id);
            if(el) { 
                if(el.type==='checkbox') el.checked = v==='1'; 
                else if(el.type==='color') el.value = '#' + v;
                else el.value = v; 
            }
        });
        update();
    }

    function openSaveModal() {
        const sub = document.getElementById('sub-cat').value;
        const list = document.getElementById('modal-name-list');
        list.innerHTML = '<option value="NEW">-- √öJ SABLON --</option>';
        templates.filter(t => t.subCategory === sub).forEach(t => list.add(new Option(t.name, t.name)));
        document.getElementById('save-modal').style.display = 'block';
        toggleNewName();
    }

    function toggleNewName() {
        document.getElementById('modal-new-name').style.display = (document.getElementById('modal-name-list').value === 'NEW' ? 'block' : 'none');
    }

    function confirmSave() {
        const sub = document.getElementById('sub-cat').value;
        const sel = document.getElementById('modal-name-list').value;
        const name = (sel === 'NEW' ? document.getElementById('modal-new-name').value : sel);
        if(!name) return;

        const p = new URLSearchParams();
        inputIds.forEach(id => {
            const el = document.getElementById(id);
            const val = el.type==='checkbox' ? (el.checked?'1':'0') : el.value.replace('#','');
            if(val) p.set(id==='eff'?'effect':id, val);
        });

        templates = templates.filter(t => !(t.name === name && t.subCategory === sub));
        templates.push({ name, subCategory: sub, params: p.toString() });

        const out = document.getElementById('json-out');
        out.style.display = 'block';
        out.value = JSON.stringify({templates}, null, 2);
        document.getElementById('save-modal').style.display = 'none';
        renderTemplates();
    }

    function update() {
        const p = new URLSearchParams();
        inputIds.forEach(id => {
            const el = document.getElementById(id);
            const val = el.type==='checkbox' ? (el.checked?'1':'0') : el.value.replace('#','');
            if(val) p.set(id==='eff'?'effect':id, val);
        });
        if(editMode) p.set('edit', '1');
        const finalUrl = 'index.html?' + p.toString();
        document.getElementById('ifr').src = finalUrl;
        document.getElementById('url-display').innerText = window.location.href.replace('admin.html', finalUrl.replace('&edit=1',''));
    }

    function copyLink() {
        navigator.clipboard.writeText(document.getElementById('url-display').innerText);
        alert("Link m√°solva!");
    }

    window.onload = init;
</script>
</body>
</html>
